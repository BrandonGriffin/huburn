!function(){angular.module("huburn").directive("huburnVelocity",["d3",function(e){return{restrict:"E",scope:{data:"="},link:function(n,a,r){var i=e.select(a[0]).append("svg").attr({"class":"velocity"}),s=function(n){if(i.selectAll("*").remove(),n&&n.length){var a=function(t){return t.points},r=i.node().offsetWidth,s=i.node().offsetHeight,c=20,l=2,o=r-150-3*c,u=e.scale.linear().domain([0,e.max(n,a)]).range([s-2*c,0]),d=e.svg.axis().scale(u).orient("left").tickSize(o).ticks(2),f=i.append("g").attr({"class":"axis",transform:"translate("+(o+2*c)+","+c+")"}).call(d),p=function(t){return new Date(t.due_on)},m=e.time.scale().domain([e.min(n,p),e.max(n,p)]).rangeRound([0,o]),g=e.svg.axis().scale(m).orient("bottom").ticks(e.time.months,3).tickSize(0).tickFormat(e.time.format("%b")),x=i.append("g").attr({"class":"axis",transform:"translate(0,"+(s-c)+")"}).call(g);i.selectAll("rect").data(n).enter().append("rect").attr({height:0,width:(o-c)/n.length-l,x:function(t,e){return e*(o-8)/n.length+2*c+5},y:s-c}).transition().duration(750).attr({height:function(t){return s-2*c-u(a(t))},y:function(t){return c+u(a(t))}}),i.selectAll("rect").append("title").text(function(t){return t.title+" - "+t.points+" points"});var h=n.slice(-8);t(i,o+3*c,5,"Velocity",e.mean(h,a).toFixed(1))}};n.$watch("data",function(t,e){return s(t)},!0)}}}]);var t=function(t,e,n,a,r){var i=t.append("g").attr({"class":"badge",transform:"translate("+e+","+n+")"});i.append("text").attr({"class":"title",x:0,y:28}).text(a),i.append("text").attr({"class":"value",x:0,y:76}).text(r)}}();